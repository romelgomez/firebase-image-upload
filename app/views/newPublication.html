<section ng-controller="PublicationsController" cg-busy="{promise:httpRequestPromise,message:'Just a moment'}">

  <div class="panel panel-default" style="display: none;">
    <div class="panel-heading">Debug</div>
    <div class="panel-body">


    </div>
  </div>


  <div class="panel panel-default" ng-show="categoryExpected === false">
    <div class="panel-heading">
      <h3 class="panel-title">Seleccione una categoría:</h3>
    </div>
    <div class="list-group">
      <button type="button" class="list-group-item" ng-click="setCategory(node.$id)" ng-repeat="node in treeNodes | filter:{parentId: (model.categoryId) ? model.categoryId: ''}:true" ><i style="color: #286090" class="fa fa-folder"></i> {{node.name | capitalizeFirstChar}}</button>
    </div>
    <div class="panel-body">

      <ol class="breadcrumb" style="margin-bottom: 7px;">
        <li ng-click="model.categoryId =''; path =[];" ng-class="{'a-link': path.length > 0}" > Home </li>
        <li ng-repeat="node in path" ng-click="setCategory(node.$id)" ng-class="{'a-link': !$last}"> {{node.name | capitalizeFirstChar}} </li>
      </ol>

      <small>
        NOTAS:
        <ul>
          <li>Seleccione la categoría que mejor se adapte a la publicación. No importa si es muy general o específica, lo importante es que seleccione una.</li>
          <li>Seleccionar una categoría específica es preferible ya que permitirá al usuario filtrar con mayor eficacia las publicaciones, sin embargo si la categoría específica no está disponible, seleccione una categoría general.</li>
        </ul>
      </small>

      <!--<pre>{{treeNodes | json }}</pre>-->

    </div>
    <div class="panel-footer" style="text-align: right;">
      <button ng-click="categoryExpected = true" type="button" class="btn btn-primary" ng-disabled="model.categoryId ===''" >Confirm selection</button>
    </div>
  </div>

  <div class="panel panel-default" ng-show="categoryExpected">
    <div class="panel-heading">
      <h3 class="panel-title">New Publication</h3>
    </div>
    <div class="panel-body">

      <ol class="breadcrumb" style="margin-bottom: 7px;">
        <li> Home </li>
        <li ng-repeat="node in path"> {{node.name | capitalizeFirstChar}} </li>
      </ol>

      <button ng-click="categoryExpected = false; model.categoryId =''; path =[];" type="button" class="btn btn-default">Edit category</button>
      <button form="{{model.type}}" class="btn btn-primary"	type="submit" >Publish</button>
      <button class="btn btn-warning"	type="button" >Discard</button>
      <hr>

      <!--<button id="update"   type="button" class="btn btn-primary"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> Update</button>-->
      <!--<button type="button" class="btn btn-default publication-status-button"><span class="glyphicon glyphicon-pause" aria-hidden="true"></span> Pause</button>-->
      <!--<button type="button" class="btn btn-default publication-status-button"><span class="glyphicon glyphicon-play"></span> Enable</button>-->
      <!--<button id="delete"   class="btn btn-danger" type="button"><span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> Delete</button>-->

      <!--<button  class="btn btn-primary" type="submit">Enviar</button>-->
      <!--<div id="debugTime" style="padding-top: 10px; ">The publication was updated at <span id="lastTimeSave"></span> (Minutes <span id="minutesElapsed">0</span> ago)</div>-->
      <!--<div id="debugTime" style="padding-top: 10px; ">The draft was updated at <span id="lastTimeSave"></span> (Minutes <span id="minutesElapsed">0</span> ago)</div>-->

      <publication-type model-type="model.type" model="model"></publication-type>

      <div class="alert alert-info" style="margin-bottom: 0;" role="alert">NOTE: This superscript <sup style="color: red;">*</sup> mean that, is required.</div>

    </div>
    <ul class="list-group">
      <li class="list-group-item">
        <ng-drop-zone data-drop-zone-instance="dropZoneInstance" data-drop-zone-config="dropZoneConfig" ></ng-drop-zone>
      </li>
    </ul>

  </div>


  <pre>{{model.type | json}}</pre>
  <pre>{{model | json}}</pre>

</section>


<script type="text/ng-template" id="dropZoneTemplate.html">
  <h3 class="page-header" style="margin-top: 10px;">Images  <sup style="color: red;">*</sup> <small><button ng-show="continueUpload" type="button" class="btn btn-link clickable">Add more pictures!</button> <button ng-show="uploadAllButton" type="button" class="btn btn-link">Upload images!</button></small></h3>
  <div id="previews" class="well dropzone dropzone-previews" style="margin-bottom: 10px;">
    <button ng-click="firstFiles()" class="btn btn-primary clickable">Select the images from the computer</button>
  </div>
</script>


<script type="text/ng-template" id="market.html">
  <form id="market" name="form" novalidate="" ng-submit="submit()">
    <div class="form-group">
      <label class="control-label"><span class="glyphicon glyphicon-bookmark"></span> Title <sup style="color: red;">*</sup></label>
      <input type="text" name="title" ng-model="model.title" required minlength="7" class="form-control" placeholder="">
      <div data-ng-messages="form.$submitted && form.title.$error" class="help-block">
        <div data-ng-message="required">
          - The <b>title</b> is required.
        </div>
        <div data-ng-message="minlength" >
          - The <b>title</b> must be at least 7 characters long.
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="control-label"><span class="glyphicon glyphicon-book"></span> Description <sup style="color: red;">*</sup></label>
      <textarea redactor name="description" ng-model="model.description" required class="form-control" placeholder=""></textarea>
      <div data-ng-messages="form.$submitted && form.description.$error" class="help-block">
        <div data-ng-message="required" >
          - The <b>description</b> is required.
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="row">
        <div class="col-xs-4">
          <label class="control-label"><span class="glyphicon glyphicon-tag"></span> Price <sup style="color: red;">*</sup></label>
          <div class="input-group">
            <div class="input-group-addon">$</div>
            <input name="price" ng-model="model.price" required class="form-control" placeholder="Eje: 1000" type="number">
          </div>
          <div data-ng-messages="form.$submitted && form.price.$error" class="help-block">
            <div data-ng-message="required">
              - The <b>price</b> is required.
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="row">
        <div class="col-xs-4">
          <label class="control-label"><i class="fa fa-cubes"></i> Quantity in stock <sup style="color: red;">*</sup></label>
          <div class="input-group">
            <div class="input-group-addon">Units</div>
            <input name="quantity" ng-model="model.quantity" required class="form-control" placeholder="Eje: 100" type="number">
          </div>
          <div data-ng-messages="form.$submitted && form.quantity.$error" class="help-block">
            <div data-ng-message="required">
              - The <b>quantity</b> is required.
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="row">
        <div class="col-xs-4">
          <label><i class="fa fa-barcode"></i> Barcode</label>
          <input name="barcode" ng-model="model.barcode" class="form-control" placeholder="" type="text">
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="control-label"><i class="fa fa-certificate"></i> Warranty <sup style="color: red;">*</sup></label>
      <textarea redactor name="warranty" ng-model="model.warranty" required class="form-control" placeholder=""></textarea>
      <div data-ng-messages="form.$submitted && form.description.$error" class="help-block">
        <div data-ng-message="required" >
          - The <b>Warranty</b> is required.
        </div>
      </div>
    </div>
  </form>
</script>

<script type="text/ng-template" id="jobs.html">
  <form id="jobs" name="form" novalidate="" ng-submit="submit()">
    <div class="form-group">
      <label class="control-label"><span class="glyphicon glyphicon-bookmark"></span> Title <sup style="color: red;">*</sup></label>
      <input type="text" name="title" ng-model="model.title" required minlength="7" class="form-control" placeholder="">
      <div data-ng-messages="form.$submitted && form.title.$error" class="help-block">
        <div data-ng-message="required">
          - The <b>title</b> is required.
        </div>
        <div data-ng-message="minlength" >
          - The <b>title</b> must be at least 7 characters long.
        </div>
      </div>
    </div>

    <div class="form-group">
      <label class="control-label"><span class="glyphicon glyphicon-book"></span> Description <sup style="color: red;">*</sup></label>
      <textarea redactor name="description" ng-model="model.description" required class="form-control" placeholder=""></textarea>
      <div data-ng-messages="form.$submitted && form.description.$error" class="help-block">
        <div data-ng-message="required" >
          - The <b>description</b> is required.
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="row">
        <div class="col-xs-4">
          <label><i class="fa fa-barcode"></i> Barcode</label>
          <input name="barcode" ng-model="model.barcode" class="form-control" placeholder="" type="text">
        </div>
      </div>
    </div>
  </form>
</script>
