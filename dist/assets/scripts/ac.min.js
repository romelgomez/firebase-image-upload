"use strict";$.cloudinary.config().cloud_name="berlin",angular.module("account",["trTrustpass","ngPasswordStrength","cloudinary","algoliasearch"]).controller("AccountController",["$scope","$q","user","$uibModal","FireRef","$firebaseObject","notificationService","$log",function(e,o,n,l,a,i,s,t){e.account={user:n,profile:i(a.child("users/"+n.uid)),publications:{},publicationsImages:{}}}]).controller("AccountProfileController",["$scope","$uibModal","notificationService",function(e,o,n){e.account.httpRequestPromise=e.account.profile.$loaded(null,function(e){n.error(e)});var l=function(e){switch(e){case"escape key press":n.notice("This action was canceled by the user");break;case void 0:n.notice("This action was canceled by the user");break;case"backdrop click":n.notice("This action was canceled by the user");break;default:n.error(e)}};e.changeProfileDetails=function(a){var i=o.open({templateUrl:"accountProfileDetailsModal.html",controller:"AccountProfileDetailsModalController",size:a,resolve:{profile:function(){return e.account.profile}}});i.result.then(function(){n.success("The profile has been updated.")},function(e){l(e)})},e.changePassword=function(a){var i=o.open({templateUrl:"accountProfilePasswordModal.html",controller:"AccountProfilePasswordModalController",size:a,resolve:{profile:function(){return e.account.profile}}});i.result.then(function(){n.success("The password has been updated.")},function(e){l(e)})},e.changeEmail=function(a){var i=o.open({templateUrl:"accountProfileEmailModal.html",controller:"AccountProfileEmailModalController",size:a,resolve:{profile:function(){return e.account.profile}}});i.result.then(function(){n.success("The email has been updated.")},function(e){l(e)})}}]).controller("AccountBillingController",["$scope",function(e){}]).controller("AccountProfileDetailsModalController",["$scope","$modalInstance","profile",function(e,o,n){e.forms={profileDetails:{}},e.profile=n;angular.copy(e.model={profileDetails:{names:angular.isDefined(n.names)&&""!==n.names?n.names:"",lastNames:angular.isDefined(n.lastNames)&&""!==n.lastNames?n.lastNames:"",mobilePhone:angular.isDefined(n.mobilePhone)&&""!==n.mobilePhone?n.mobilePhone:"",landLineTelephone:angular.isDefined(n.landLineTelephone)&&""!==n.landLineTelephone?n.landLineTelephone:"",email:angular.isDefined(n.email)&&""!==n.email?n.email:""}});e.submit=function(){e.forms.profileDetails.$valid&&(n.names=e.model.profileDetails.names,n.lastNames=e.model.profileDetails.lastNames,n.mobilePhone=e.model.profileDetails.mobilePhone,n.landLineTelephone=e.model.profileDetails.landLineTelephone,"password"!==n.provider&&(n.email=angular.isDefined(e.model.profileDetails.email)?e.model.profileDetails.email:""),e.httpRequestPromise=n.$save().then(function(){o.close()},function(e){o.dismiss(e)}))},e.cancel=function(){o.dismiss()}}]).controller("AccountProfilePasswordModalController",["$scope","$modalInstance","FireAuth","profile",function(e,o,n,l){e.forms={accountPassword:{}};angular.copy(e.model={accountPassword:{oldPassword:"",newPassword:"",sameNewPassword:""}});e.submit=function(){e.forms.accountPassword.$valid&&(e.httpRequestPromise=n.$changePassword({email:l.email,oldPassword:e.model.accountPassword.oldPassword,newPassword:e.model.accountPassword.newPassword}).then(function(){o.close()},function(e){o.dismiss(e)}))},e.cancel=function(){o.dismiss()}}]).controller("AccountProfileEmailModalController",["$q","$scope","$modalInstance","FireAuth","profile",function(e,o,n,l,a){o.forms={emailAccount:{}};var i=angular.copy(o.model={emailAccount:{newEmail:"",password:""}});o.submit=function(){if(o.forms.emailAccount.$valid){var i=e.defer();o.httpRequestPromise=i.promise,l.$changeEmail({password:o.model.emailAccount.password,newEmail:o.model.emailAccount.newEmail,oldEmail:a.email}).then(function(){return a.email=o.model.emailAccount.newEmail,a.$save()}).then(function(){n.close(),i.resolve()},function(e){n.dismiss(e),i.reject(e)})}},o.resetForm=function(){angular.copy(i.emailAccount,o.model.emailAccount),o.forms.emailAccount.$setUntouched(),o.forms.emailAccount.$setPristine()},o.cancel=function(){n.dismiss()}}]);